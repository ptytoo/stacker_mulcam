<%= form_for(@service, url: "/enter/companies/#{current_user.company_id}/services/#{@service.id}", method: :put) do |f| %>
  <% if @service.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@service.errors.count, "error") %> prohibited this service from being saved:</h2>

      <ul>
      <% @service.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>

  <div class="field">
    <%= f.label :name %><br>
    <%= f.text_field :name %>
  </div>
  <div class="field">
    <%= f.label :site_url %><br>
    <%= f.text_field :site_url %>
  </div>
  <div class="field">
    <%= f.label :logo_url %><br>
    <%= f.file_field :logo_url%>
  </div>
  <div class="field">
    <%= f.label :describe %><br>
    <%= f.text_area :describe %>
  </div>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>

<input type="button" value = "스택 등록" id="aa">

<%@stacks.each do |stack|%>
  <div>
    <%#= stack.name %>
    <img class="img" src="https://s3.ap-northeast-2.amazonaws.com/dahisy-4th-project/Stack/<%=stack.stack_field.name%>/<%= stack.name.capitalize %>.png" width="100">
    <%=hidden_field_tag "", current_user.my?(stack), class: "cb", stack_id: stack.id%>
  </div>
<%end%>


<script>
  $(function(){
    console.log(<%=@company.id%>)
    $('#company_id').val(<%=current_user.company_id%>);

    $(".cb").each(function(){
      if($(this).val() == "true"){
          $(this).parent("div").css("border","1px solid red");
      }
    })
    $(".img").on("click",function(){
      console.log()
      var value = $(this).siblings(".cb").val()
      if(value == "true"){
        $(this).siblings(".cb").val("false")
        $(this).parent("div").css("border","0px");
      }else{
        $(this).siblings(".cb").val("true")
        $(this).parent("div").css("border","1px solid red");
      }
    })
    $("#aa").on("click", function(){
      var ret = []
      $(".cb[value=true]").each(function(){
        ret.push($(this).attr("stack_id"))
      });
      console.log(ret);
      $.ajax({
        url: "<%= enter_register_stack_path %>",
        method: "POST",
        data: {return_val : ret}
      });
    });
  })
</script>
